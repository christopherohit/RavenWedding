<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Ribbon="using:DevExpress.UI.Xaml.Ribbon"
    xmlns:Xaml="using:DevExpress.UI.Xaml"
    xmlns:XamlInternal="using:DevExpress.UI.Xaml.Internal"
    xmlns:Core="using:DevExpress.Core"
    xmlns:Editors="using:DevExpress.UI.Xaml.Editors"
    xmlns:Internal="using:DevExpress.UI.Xaml.Ribbon.Internal"
    xmlns:Controls="using:DevExpress.UI.Xaml.Controls">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="ms-appx:///DevExpress.UI.Xaml.Ribbon.v19.2/Themes/Ribbon.Colors.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <Internal:RibbonViewModeToBoolConverter x:Key="RibbonViewModeToBoolConverter"/>
    <Internal:RibbonStateToBoolConverter x:Key="RibbonStateToBoolConverter"/>
    <Core:BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    
    <DataTemplate x:Key="WindowTitleSettings">
        <Xaml:TitleSettings Background="{ThemeResource RibbonWindowTitleBackgroundBrush}"
                            InactiveBackground="{ThemeResource RibbonWindowTitleInactiveBackgroundBrush}"
                            ButtonBackground="{ThemeResource RibbonWindowTitleButtonBackgroundBrush}"
                            ButtonHoverBackground="{ThemeResource RibbonWindowTitleButtonBackgroundHoverBrush}"
                            ButtonPressedBackground="{ThemeResource RibbonWindowTitleButtonBackgroundPressedBrush}"
                            ButtonInactiveBackground="{ThemeResource RibbonWindowTitleButtonInactiveBackgroundBrush}"
                            Foreground="{ThemeResource RibbonWindowTitleForegroundBrush}"
                            InactiveForeground="{ThemeResource RibbonWindowTitleInactiveForegroundBrush}"
                            ButtonForeground="{ThemeResource RibbonWindowTitleButtonForegroundBrush}"
                            ButtonHoverForeground="{ThemeResource RibbonWindowTitleButtonForegroundHoverBrush}"
                            ButtonPressedForeground="{ThemeResource RibbonWindowTitleButtonForegroundPressedBrush}"
                            ButtonInactiveForeground="{ThemeResource RibbonWindowTitleButtonInactiveForegroundBrush}"/>
    </DataTemplate>

    <Style TargetType="Ribbon:RibbonControl">
        <Setter Property="Core:StyleHelper.BindableSetters">
            <Setter.Value>
                <Core:BindableSetterCollection>
                    <Core:BindableSetter Property="TitleSettings" 
                                         Binding="{Binding Source={StaticResource WindowTitleSettings}, Converter={Core:TemplateInstanceConverter}, Mode=OneTime}"/>
                </Core:BindableSetterCollection>
            </Setter.Value>
        </Setter>
        <Setter Property="VerticalAlignment" Value="Stretch"/>
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="Background" Value="{ThemeResource RibbonControlBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{ThemeResource RibbonControlForegroundBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="FontSize" Value="16"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Ribbon:RibbonControl">
                    <Grid BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          Background="{TemplateBinding Background}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup >
                                <VisualState x:Name="compact">
                                    <VisualState.StateTriggers>
                                        <Internal:RibbonAdaptiveTrigger IsEnabled="{Binding ShowTitleBar, RelativeSource={RelativeSource Mode=TemplatedParent}}" 
                                                                        Inverted="True" 
                                                                        ControlSize="{Binding ActualSize, RelativeSource={RelativeSource Mode=TemplatedParent}}" MinControlWidth="720"/>
                                    </VisualState.StateTriggers>
                                    <VisualState.Setters>
                                        <Setter Target="PART_Title.HorizontalAlignment" Value="Left" />
                                        <Setter Target="PART_Title.(Grid.ColumnSpan)" Value="1" />
                                        <Setter Target="PART_HeaderControl.(Grid.ColumnSpan)" Value="2"/>
                                        <Setter Target="PART_HelpPane.(Grid.Row)" Value="0"/>
                                        <Setter Target="PART_HelpPane.IsCompact" Value="True"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ViewModeStates">
                                <VisualState x:Name="AutoHideView">
                                    <VisualState.StateTriggers>
                                        <StateTrigger IsActive="{Binding ViewMode, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource RibbonViewModeToBoolConverter}, ConverterParameter=AutoHide}"/>
                                    </VisualState.StateTriggers>
                                    <VisualState.Setters>
                                        <Setter Target="PART_Content.(Grid.Row)" Value="2"/>
                                        <Setter Target="PART_Content.(Grid.RowSpan)" Value="1"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="RibbonStates">
                                <VisualState x:Name="Normal">
                                    <VisualState.StateTriggers>
                                        <StateTrigger IsActive="{Binding State, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource RibbonStateToBoolConverter}, ConverterParameter=Normal}"/>
                                    </VisualState.StateTriggers>
                                    <VisualState.Setters>
                                        <Setter Target="PART_RibbonContent.Visibility" Value="Visible"/>
                                    </VisualState.Setters>
                                    <VisualState.Storyboard>
                                        <Storyboard>
                                            <DoubleAnimation Duration="0:0:0.1"
                                                             From="0"
                                                             To="1"
                                                             Storyboard.TargetName="PART_RibbonContentTransform"
                                                             Storyboard.TargetProperty="ScaleY"
                                                             EnableDependentAnimation="True">
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </VisualState.Storyboard>
                                </VisualState>
                                <VisualState x:Name="Hidden">
                                    <VisualState.StateTriggers>
                                        <StateTrigger IsActive="{Binding State, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource RibbonStateToBoolConverter}, ConverterParameter=Hidden}"/>
                                    </VisualState.StateTriggers>
                                    <VisualState.Setters>
                                        <Setter Target="PART_HelpPane.Opacity" Value="0"/>
                                        <Setter Target="PART_HeaderControl.Opacity" Value="0"/>
                                        <Setter Target="PART_ShowButton.Opacity" Value="1"/>
                                        <Setter Target="PART_ShowButton.IsHitTestVisible" Value="True"/>
                                        <Setter Target="PART_RibbonContent.Visibility" Value="Collapsed"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Minimized">
                                    <VisualState.StateTriggers>
                                        <StateTrigger IsActive="{Binding State, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource RibbonStateToBoolConverter}, ConverterParameter=Minimized}"/>
                                    </VisualState.StateTriggers>
                                    <VisualState.Storyboard>
                                        <Storyboard>
                                            <DoubleAnimation Duration="0:0:0.1"
                                                             From="1"
                                                             To="0"
                                                             Storyboard.TargetName="PART_RibbonContentTransform"
                                                             Storyboard.TargetProperty="ScaleY"
                                                             EnableDependentAnimation="True">
                                            </DoubleAnimation>
                                            <ObjectAnimationUsingKeyFrames BeginTime="0:0:0.1" 
                                                                           Storyboard.TargetName="PART_RibbonContent"
                                                                           Storyboard.TargetProperty="Visibility"
                                                                           EnableDependentAnimation="True">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState.Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Border x:Name="PART_Background"
                                Background="{ThemeResource RibbonControlHeaderBackgroundBrush}"
                                Grid.ColumnSpan="2"
                                Grid.RowSpan="2"/>
                        <Border x:Name="PART_TitleBorder" 
                                Height="32" 
                                HorizontalAlignment="Stretch" 
                                VerticalAlignment="Top" 
                                Background="Transparent" 
                                IsHitTestVisible="True" 
                                Grid.ColumnSpan="3"
                                Visibility="{Binding ShowTitleBar, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        <Internal:RibbonFlyoutTitleControl x:Name="PART_Title"
                                                           HorizontalAlignment="Center"
                                                           IsTitleEditable="{TemplateBinding IsTitleEditable}" 
                                                           Title="{Binding Title, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}"
                                                           Grid.ColumnSpan="2"
                                                            Visibility="{Binding ShowTitleBar, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        <XamlInternal:MenuFlyoutControl x:Name="PART_BackstageFlyoutHost"
                                                      AnimationDuration="0:0:0.3"
                                                      VerticalContentAlignment="Stretch"
                                                      HorizontalContentAlignment="Stretch"
                                                      VerticalAlignment="Stretch"
                                                      HorizontalAlignment="Stretch"
                                                      Background="Transparent"
                                                      Content="{TemplateBinding BackstageView}"
                                                      IsOpen="{Binding BackstageView.IsOpen, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}"
                                                      StaysOpen="{Binding BackstageView.StaysOpen, RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                                      PlacementTarget="{Binding BackstageView.ActualPlacementTarget, RelativeSource={RelativeSource Mode=TemplatedParent}}">
                            <XamlInternal:MenuFlyoutControl.Settings>
                                <Ribbon:BackstageFlyoutSettings />
                            </XamlInternal:MenuFlyoutControl.Settings>
                        </XamlInternal:MenuFlyoutControl>
                        <Internal:RibbonHelpPaneView x:Name="PART_HelpPane"
                                                     AutomationProperties.Name="HelpPaneView"
                                                     HorizontalAlignment="Right"
                                                     VerticalAlignment="Top"
                                                     Grid.Row="1"
                                                     Grid.Column="1"
                                                     IsCompact="False"
                                                     HelpPane="{TemplateBinding HelpPane}"
                                                     ShowSeparator="{TemplateBinding EmbedRibbonInWindowTitle}"/>
                        <Internal:RibbonHeaderControl x:Name="PART_HeaderControl"
                                                      Owner="{Binding RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                                      HorizontalAlignment="Stretch"
                                                      Grid.Row="1"
                                                      Grid.ColumnSpan="1"
                                                      Grid.Column="0"/>
                        <Ribbon:HelpPaneButton x:Name="PART_ShowButton"
                                               AutomationProperties.Name="ShowRibbonButton"
                                               IconSource="F1 M 0,1 0,3 1,4 3,4 4,3 4,1 3,0 1,0 Z
                                                        M 7,1 7,3 8,4 10,4 11,3 11,1 10,0 8,0 Z
                                                        M 14,1 14,3 15,4 17,4 18,3 18,1 17,0 15,0 Z"
                                               IconFill="{ThemeResource RibbonControlHelpPaneButtonIconFillBrush}"
                                               HorizontalAlignment="Stretch"
                                               VerticalAlignment="Stretch"
                                               HorizontalContentAlignment="Right"
                                               VerticalContentAlignment="Center"
                                               Opacity="0"
                                               IsHitTestVisible="False"
                                               CommandParameter="Normal"
                                               Command="{Binding ChangeRibbonStateCommand, RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                               Grid.ColumnSpan="2"
                                               Grid.Row="1"/>
                        <ContentPresenter x:Name="PART_Content"
                                          Grid.ColumnSpan="2"
                                          Grid.Row="3"/>
                        <Internal:RibbonContentHost x:Name="PART_RibbonContent"
                                                    Owner="{Binding RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                                    Grid.Row="2" 
                                                    Grid.ColumnSpan="2">
                            <Internal:RibbonContentHost.RenderTransform>
                                <ScaleTransform x:Name="PART_RibbonContentTransform" CenterY="0" ScaleY="1"/>
                            </Internal:RibbonContentHost.RenderTransform>
                        </Internal:RibbonContentHost>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RibbonTabStyleBase" TargetType="Ribbon:RibbonTab">
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="Padding" Value="16,0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Ribbon:RibbonTab">
                    <Border x:Name="PART_Background"
                            Background="{TemplateBinding Background}"
                            Padding="{TemplateBinding Padding}"
                            Visibility="{Binding IsSelected, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}">
                        <Border.RenderTransform>
                            <TranslateTransform x:Name="PART_BackgroundTransform"/>
                        </Border.RenderTransform>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="VisibilityStatesGroup">
                                <VisualState x:Name="Visible">
                                    <VisualState.Storyboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="PART_Background"
                                                             Storyboard.TargetProperty="Opacity"
                                                             From="0"
                                                             To="1"
                                                             Duration="0:0:0.25"/>
                                            <DoubleAnimation Storyboard.TargetName="PART_BackgroundTransform"
                                                             Storyboard.TargetProperty="X"
                                                             From="-20"
                                                             To="0"
                                                             Duration="0:0:0.25">
                                                <DoubleAnimation.EasingFunction>
                                                    <ExponentialEase EasingMode="EaseOut"/>
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>

                                        </Storyboard>
                                    </VisualState.Storyboard>
                                </VisualState>
                                <VisualState x:Name="Collapsed">
                                    <VisualState.Storyboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="PART_Background"
                                                             Storyboard.TargetProperty="Opacity"
                                                             From="1"
                                                             To="0"
                                                             Duration="0"/>
                                        </Storyboard>
                                    </VisualState.Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Internal:RibbonTabPanel ItemsSource="{Binding Groups, RelativeSource={RelativeSource Mode=TemplatedParent}}"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="Ribbon:RibbonTab" BasedOn="{StaticResource RibbonTabStyleBase}"/>
    <Style TargetType="Ribbon:RibbonContextualTab" BasedOn="{StaticResource RibbonTabStyleBase}"/>

    <Style TargetType="Internal:RibbonGroupSeparator">
        <Setter Property="Margin" Value="0"/>
        <Setter Property="Background" Value="{ThemeResource RibbonGroupSeparatorBackgroundBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Internal:RibbonGroupSeparator">
                    <Rectangle Fill="{TemplateBinding Background}"
                               x:Name="PART_SeparatorBackground"
                               Width="1"
                               VerticalAlignment="Stretch">
                    </Rectangle>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="Internal:ToolbarGroupSeparator">
        <Setter Property="Margin" Value="0"/>
        <Setter Property="Background" Value="{ThemeResource ToolbarGroupSeparatorBackgroundBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Internal:ToolbarGroupSeparator">
                    <Rectangle Fill="{TemplateBinding Background}"
                               x:Name="PART_SeparatorBackground"
                               Width="1"
                               VerticalAlignment="Stretch">
                    </Rectangle>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="Internal:RibbonContentHost">
        <Setter Property="BorderThickness" Value="0,0,0,1"/>
        <Setter Property="Background" Value="{ThemeResource RibbonContentHostBackgroundBrush}"/>
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonContentHostBorderBrush}"/>
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="VerticalAlignment" Value="Top"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Internal:RibbonContentHost">
                    <Border Background="{TemplateBinding Background}" 
                            BorderBrush="{TemplateBinding BorderBrush}" 
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <ItemsControl x:Name="PART_TabContentContainer"
                                      ItemsSource="{Binding Owner.Tabs, RelativeSource={RelativeSource Mode=TemplatedParent}}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <Grid/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                        </ItemsControl>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
