<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dxr="using:DevExpress.UI.Xaml.Ribbon"
    xmlns:Editors="using:DevExpress.UI.Xaml.Editors"
    xmlns:Core="using:DevExpress.Core"
    xmlns:Xaml="using:DevExpress.UI.Xaml"
    xmlns:dxc="using:DevExpress.UI.Xaml.Controls"
    xmlns:Internal="using:DevExpress.UI.Xaml.Ribbon.Internal"
    xmlns:XamlInternal="using:DevExpress.UI.Xaml.Internal"
    xmlns:dxxi="using:DevExpress.UI.Xaml.Internal"
    xmlns:dxi="using:DevExpress.UI.Xaml.Editors.Native">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="ms-appx:///DevExpress.UI.Xaml.Ribbon.v20.2/Themes/Items/RibbonItems.Colors.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Internal:ThicknessNegationConverter x:Key="ThicknessNegationConverter" />
    <Core:ObjectToBooleanConverter x:Key="ObjectToBooleanConverter" />
    <Core:ObjectToVisibilityConverter x:Key="ObjectToVisibilityConverter" />
    <Core:BooleanToDoubleConverter x:Key="BoolToOpacityInvertConverter" ValueFalse="1" ValueTrue="0" />
    <Core:BooleanToDoubleConverter x:Key="BoolToOpacityConverter" ValueFalse="0" ValueTrue="1" />
    <Core:BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    <Core:BooleanToObjectConverter x:Key="BoolToIndicatorPaddingConverter">
        <Core:BooleanToObjectConverter.ValueTrue>
            <Thickness>0,0,8,0</Thickness>
        </Core:BooleanToObjectConverter.ValueTrue>
        <Core:BooleanToObjectConverter.ValueFalse>
            <Thickness>0</Thickness>
        </Core:BooleanToObjectConverter.ValueFalse>
    </Core:BooleanToObjectConverter>

    <Style TargetType="dxr:RibbonButton">
        <Setter Property="Background" Value="{ThemeResource RibbonButtonBackgroundBrush}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonButtonForegroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonButtonBorderBrush}" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Padding" Value="11" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonButton">
                    <Grid x:Name="PART_Background"
                          Background="{TemplateBinding Background}"
                          BorderThickness="{TemplateBinding BorderThickness}" 
                          BorderBrush="{TemplateBinding BorderBrush}"
                          Padding="{TemplateBinding Padding}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonButtonBackgroundHoverBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonButtonBorderHoverBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonButtonIconForegroundHoverBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonButtonForegroundHoverBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonButtonBackgroundPressedBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonButtonBorderPressedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonButtonIconForegroundPressedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonButtonForegroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Opacity" Value="0.4" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="RibbonStates">
                                <VisualState x:Name="Flyout">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.HorizontalAlignment" Value="Stretch" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Glyph">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Text" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Icon" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="GlyphWithText" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <XamlInternal:IconView x:Name="PART_Icon"
                                               UseIconPadding="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToBooleanConverter}}" />
                        <ContentPresenter x:Name="PART_Text"
                                          VerticalAlignment="Center"
                                          Grid.Column="1"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                          />
                        <Rectangle x:Name="PART_FocusVisual" 
                                   Grid.ColumnSpan="2" 
                                   IsHitTestVisible="False" 
                                   StrokeThickness="1" 
                                   Opacity="0" 
                                   Stroke="{ThemeResource RibbonButtonFocusVisualStrokeBrush}" 
                                   Fill="{ThemeResource RibbonButtonFocusVisualBackgroundBrush}"
                                   Margin="{Binding Padding, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="dxr:RibbonCheckBox">
        <Setter Property="UseSystemFocusVisuals" Value="False" />
        <Setter Property="Background" Value="{ThemeResource RibbonCheckBoxBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonCheckBoxBorderBrush}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonCheckBoxForegroundBrush}" />
        <Setter Property="Padding" Value="11" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="Margin" Value="1" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonCheckBox">
                    <Grid x:Name="PART_Background"
                          Background="{TemplateBinding Background}"
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}" 
                          >
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="27" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="NormalRectangle.Fill" Value="{ThemeResource RibbonCheckBoxBackgroundHoverBrush}" />
                                        <Setter Target="NormalRectangle.Stroke" Value="{ThemeResource RibbonCheckBoxBorderHoverBrush}" />
                                        <Setter Target="CheckGlyph.Fill" Value="{ThemeResource RibbonCheckBoxGlyphFillHoverBrush}" />
                                        <Setter Target="IndeterminateGlyph.Fill" Value="{ThemeResource RibbonCheckBoxIndeterminateGlyphFillHoverBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="NormalRectangle.Fill" Value="{ThemeResource RibbonCheckBoxBackgroundPressedBrush}" />
                                        <Setter Target="NormalRectangle.Stroke" Value="{ThemeResource RibbonCheckBoxBorderPressedBrush}" />
                                        <Setter Target="CheckGlyph.Fill" Value="{ThemeResource RibbonCheckBoxGlyphFillPressedBrush}" />
                                        <Setter Target="IndeterminateGlyph.Fill" Value="{ThemeResource RibbonCheckBoxIndeterminateGlyphFillPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Opacity" Value="0.4" />
                                        <Setter Target="NormalRectangle.Fill" Value="{ThemeResource RibbonCheckBoxBackgroundDisabledBrush}" />
                                        <Setter Target="CheckGlyph.Fill" Value="{ThemeResource RibbonCheckBoxGlyphFillDisabledBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="CheckStates">
                                <VisualState x:Name="Checked">
                                    <VisualState.Setters>
                                        <Setter Target="CheckGlyph.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="CheckedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="CheckGlyph.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="CheckedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="CheckGlyph.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Indeterminate">
                                    <VisualState.Setters>
                                        <Setter Target="IndeterminateGlyph.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="IndeterminatePointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="IndeterminateGlyph.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="IndeterminatePressed">
                                    <VisualState.Setters>
                                        <Setter Target="IndeterminateGlyph.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unchecked" />
                                <VisualState x:Name="UncheckedPressed" />
                                <VisualState x:Name="UncheckedPointerOver" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid VerticalAlignment="Center">
                            <Rectangle x:Name="NormalRectangle" 
                                       Fill="{ThemeResource RibbonCheckBoxNormalRectFillBrush}" 
                                       Stroke="{ThemeResource RibbonCheckBoxNormalRectStrokeBrush}"
                                       Height="21" 
                                       StrokeThickness="1" 
                                       UseLayoutRounding="False" 
                                       Width="21" />
                            <Path x:Name="CheckGlyph" 
                                  Data="F1 M 0,58 L 2,56 L 6,60 L 13,51 L 15,53 L 6,64 z" 
                                  Fill="{ThemeResource RibbonCheckBoxGlyphFillBrush}" 
                                  FlowDirection="LeftToRight" 
                                  Height="14" 
                                  Opacity="0" 
                                  Stretch="Fill"
                                  Width="16" />
                            <Rectangle x:Name="IndeterminateGlyph"
                                       Fill="{ThemeResource RibbonCheckBoxIndeterminateGlyphFillBrush}" 
                                       Height="9" 
                                       Opacity="0" 
                                       UseLayoutRounding="False" 
                                       Width="9" />
                            <Rectangle x:Name="PART_FocusVisual" 
                                       IsHitTestVisible="False" 
                                       StrokeThickness="1" 
                                       Height="27"
                                       Width="27"
                                       Opacity="0" 
                                       Stroke="{ThemeResource RibbonCheckBoxFocusVisualStrokeBrush}" 
                                       Fill="{ThemeResource RibbonCheckBoxFocusVisualBackgroundBrush}" />
                        </Grid>
                        <ContentPresenter x:Name="ContentPresenter" 
                                          Grid.Column="1"
                                          AutomationProperties.AccessibilityView="Raw"  
                                          Content="{TemplateBinding Content}" 
                                          Margin="{TemplateBinding Padding}" 
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="dxr:RibbonColorEdit">
        <Setter Property="Background" Value="{ThemeResource RibbonColorEditBackgroundBrush}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonColorEditForegroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonColorEditBorderBrush}" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Padding" Value="12" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonColorEditBase">
                    <Grid x:Name="PART_Background"
                          Background="{TemplateBinding Background}"
                          BorderThickness="{TemplateBinding BorderThickness}" 
                          BorderBrush="{TemplateBinding BorderBrush}"
                          >
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected" />
                                <VisualState x:Name="UnselectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonColorEditBorderHoverBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowHoverBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonHoverBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="UnselectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonColorEditBorderPressedBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowPressedBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonPressedBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Selected">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonColorEditBorderSelectedBrush}" />
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonColorEditBackgroundSelectedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonColorEditBorderSelectedHoverBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowHoverBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonHoverBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonColorEditBorderSelectedPressedBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowPressedBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonPressedBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="RibbonStates">
                                <VisualState x:Name="Flyout">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Button" Storyboard.TargetProperty="(Grid.ColumnSpan)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="1" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Separator" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Background" Storyboard.TargetProperty="HorizontalAlignment">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Stretch" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowGlyph" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_FlyoutArrowGlyph" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Arrow" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="16,0" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Button" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="11" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_FocusVisual" Storyboard.TargetProperty="Margin">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Glyph">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Icon" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ButtonText" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="GlyphWithText" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ArrowStates">
                                <VisualState x:Name="ArrowActive" />
                                <VisualState x:Name="ArrowInactive">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Arrow" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="HoverStates">
                                <VisualState x:Name="HoverArrow">
                                    <VisualState.Setters>
                                        <Setter Target="PART_ArrowHoverBackground.Fill" Value="{ThemeResource RibbonColorEditArrowBackgroundHoverBrush}" />
                                        <Setter Target="PART_ArrowPressedBackground.Fill" Value="{ThemeResource RibbonColorEditArrowBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="HoverButton">
                                    <VisualState.Setters>
                                        <Setter Target="PART_ButtonHoverBackground.Fill" Value="{ThemeResource RibbonColorEditContentBackgroundHoverBrush}" />
                                        <Setter Target="PART_ButtonPressedBackground.Fill" Value="{ThemeResource RibbonColorEditContentBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="HoverBoth">
                                    <VisualState.Setters>
                                        <Setter Target="PART_ArrowHoverBackground.Fill" Value="{ThemeResource RibbonColorEditArrowBackgroundHoverBrush}" />
                                        <Setter Target="PART_ArrowPressedBackground.Fill" Value="{ThemeResource RibbonColorEditArrowBackgroundPressedBrush}" />
                                        <Setter Target="PART_ButtonHoverBackground.Fill" Value="{ThemeResource RibbonColorEditContentBackgroundHoverBrush}" />
                                        <Setter Target="PART_ButtonPressedBackground.Fill" Value="{ThemeResource RibbonColorEditContentBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Rectangle x:Name="PART_ButtonHoverBackground" Opacity="0" 
                                   />
                        <Rectangle x:Name="PART_ButtonPressedBackground" Opacity="0" 
                                   />

                        <Rectangle x:Name="PART_ArrowHoverBackground" Grid.Column="1"
                                   Opacity="0" 
                                   />
                        <Rectangle x:Name="PART_ArrowPressedBackground" Grid.Column="1"
                                   Opacity="0" 
                                   />

                        <Grid x:Name="PART_Button"
                              Padding="{TemplateBinding Padding}"
                              Grid.ColumnSpan="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <XamlInternal:IconView x:Name="PART_Icon"
                                                   Padding="0,0,8,0"
                                                   UseIconPadding="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToBooleanConverter}}" />
                            <Rectangle x:Name="PART_Indicator"
                                       Height="3" 
                                       Visibility="{Binding ShowIndicator, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}"
                                       Margin="{Binding UseIconPadding, ElementName=PART_Icon, Converter={StaticResource BoolToIndicatorPaddingConverter}}"
                                       VerticalAlignment="Bottom"
                                       Fill="{TemplateBinding SelectedBrush}"
                                       HorizontalAlignment="Stretch" />
                            <ContentPresenter x:Name="PART_ButtonText"
                                              VerticalAlignment="Center"
                                              Grid.Column="1"
                                              Visibility="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToVisibilityConverter}}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" />
                        </Grid>
                        <Rectangle x:Name="PART_Separator"
                                   Width="1"
                                   Grid.Column="1"
                                   VerticalAlignment="Stretch"
                                   HorizontalAlignment="Left"
                                   Visibility="Collapsed"
                                   Margin="0,4"
                                   Opacity="1"
                                   Fill="{ThemeResource RibbonColorEditSeparatorBrush}" />
                        <Grid x:Name="PART_Arrow"
                              Grid.Column="1"
                              Padding="1.5"
                              HorizontalAlignment="Right">
                            <PathIcon x:Name="PART_ArrowGlyph"
                                      Opacity="0"
                                      Data="F1 M 0,0 L 4,3 L 8,0 L 8,2 L 4,5 L 0,2 z"
                                      Foreground="{TemplateBinding Foreground}"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center" />
                            <PathIcon x:Name="PART_FlyoutArrowGlyph"
                                      Visibility="Collapsed"
                                      Data="F1 M 0,0 L 6,6 L 0,12 L 2,12 L 8,6 L 2,0 z"
                                      Foreground="{TemplateBinding Foreground}"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center" />
                        </Grid>
                        <XamlInternal:NestedMenuFlyoutControl x:Name="PART_Flyout"
                                                       AnimationDuration="0:0:0.2"
                                                       x:DeferLoadStrategy="Lazy"
                                                       Grid.ColumnSpan="2"
                                                       CloseOnTargetClick="{TemplateBinding XamlInternal:MenuFlyoutControl.CloseOnTargetClick}"
                                                       Margin="{Binding BorderThickness, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}">
                            <XamlInternal:NestedMenuFlyoutControl.HeaderContent>
                                <Grid Margin="-6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter Content="{TemplateBinding Content}"
                                                      Margin="6"
                                                      ContentTemplate="{TemplateBinding ContentTemplate}" />
                                    <dxr:RibbonToggleButton IconSource="{Binding IsChecked, RelativeSource={RelativeSource Mode=Self}}"
                                                               ClosePopupOnClick="False"
                                                               IconWidth="24"
                                                               IconHeight="24"
                                                               Padding="5"
                                                               Grid.Column="1"
                                                               IsChecked="{Binding IsInAdvancedMode, ElementName=PART_ColorEditor, Mode=TwoWay}">
                                        <dxr:RibbonToggleButton.IconTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Xaml:MultiPath Data="[F#FF323232 M 0 0  l 6 0 0 6 -6 0 z][F#FF686868 M 8 0  l 6 0 0 6 -6 0 z][F#FF9E9E9E M 16 0  l 6 0 0 6 -6 0 z]
                                                                          [F#FF444444 M 0 8  l 6 0 0 6 -6 0 z][F#FF7A7A7A M 8 8  l 6 0 0 6 -6 0 z][F#FFB0B0B0 M 16 8  l 6 0 0 6 -6 0 z]
                                                                          [F#FF565656 M 0 16 l 6 0 0 6 -6 0 z][F#FF8C8C8C M 8 16 l 6 0 0 6 -6 0 z][F#FFC2C2C2 M 16 16 l 6 0 0 6 -6 0 z]"
                                                                    Opacity="{Binding Converter={StaticResource BoolToOpacityInvertConverter}}" />
                                                    <Xaml:MultiPath Data="[F#FFFFFFFF M 0 0  l 6 0 0 6 -6 0 z][F#FFE0E0E0 M 8 0  l 6 0 0 6 -6 0 z][F#FFC0C0C0 M 16 0  l 6 0 0 6 -6 0 z]
                                                                          [F#FFF5F5F5 M 0 8  l 6 0 0 6 -6 0 z][F#FFD5D5D5 M 8 8  l 6 0 0 6 -6 0 z][F#FFB6B6B6 M 16 8  l 6 0 0 6 -6 0 z]
                                                                          [F#FFEAEAEA M 0 16 l 6 0 0 6 -6 0 z][F#FFCBCBCB M 8 16 l 6 0 0 6 -6 0 z][F#FFABABAB M 16 16 l 6 0 0 6 -6 0 z]"
                                                                    Opacity="{Binding Converter={StaticResource BoolToOpacityConverter}}" />
                                                </Grid>
                                            </DataTemplate>
                                        </dxr:RibbonToggleButton.IconTemplate>
                                    </dxr:RibbonToggleButton>
                                </Grid>
                            </XamlInternal:NestedMenuFlyoutControl.HeaderContent>
                            <Editors:ColorEdit x:Name="PART_ColorEditor"
                                               DefaultColor="{TemplateBinding DefaultColor}"
                                               Color="{Binding SelectedColor, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}" 
                                               ColorGroupsSource="{Binding ColorGroups, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                        </XamlInternal:NestedMenuFlyoutControl>
                        <Rectangle x:Name="PART_FocusVisual" 
                                   Grid.ColumnSpan="2" 
                                   IsHitTestVisible="False" 
                                   StrokeThickness="1" 
                                   Opacity="0" 
                                   Stroke="{ThemeResource RibbonColorEditFocusVisualStrokeBrush}"
                                   Fill="{ThemeResource RibbonColorEditFocusVisualBackgroundBrush}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style TargetType="dxr:RibbonToolbarColorEdit">
        <Setter Property="Background" Value="{ThemeResource RibbonToolbarColorEditBackgroundBrush}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonToolbarColorEditForegroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonToolbarColorEditBorderBrush}" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Padding" Value="12" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonColorEditBase">
                    <Grid x:Name="PART_Background"
                          Background="{TemplateBinding Background}"
                          BorderThickness="{TemplateBinding BorderThickness}" 
                          BorderBrush="{TemplateBinding BorderBrush}"
                          >
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected" />
                                <VisualState x:Name="UnselectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToolbarColorEditBorderHoverBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowHoverBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonHoverBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="UnselectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToolbarColorEditBorderPressedBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowPressedBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonPressedBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Selected">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToolbarColorEditBorderSelectedBrush}" />
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonToolbarColorEditBackgroundSelectedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToolbarColorEditBorderSelectedHoverBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowHoverBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonHoverBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToolbarColorEditBorderSelectedPressedBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowPressedBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonPressedBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="RibbonStates">
                                <VisualState x:Name="Flyout">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Button" Storyboard.TargetProperty="(Grid.ColumnSpan)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="1" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Separator" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Background" Storyboard.TargetProperty="HorizontalAlignment">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Stretch" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowGlyph" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_FlyoutArrowGlyph" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Arrow" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="16,0" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Button" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="11" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_FocusVisual" Storyboard.TargetProperty="Margin">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Glyph">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Icon" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ButtonText" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="GlyphWithText" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ArrowStates">
                                <VisualState x:Name="ArrowActive" />
                                <VisualState x:Name="ArrowInactive">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Arrow" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="HoverStates">
                                <VisualState x:Name="HoverArrow">
                                    <VisualState.Setters>
                                        <Setter Target="PART_ArrowHoverBackground.Fill" Value="{ThemeResource RibbonToolbarColorEditArrowBackgroundHoverBrush}" />
                                        <Setter Target="PART_ArrowPressedBackground.Fill" Value="{ThemeResource RibbonToolbarColorEditArrowBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="HoverButton">
                                    <VisualState.Setters>
                                        <Setter Target="PART_ButtonHoverBackground.Fill" Value="{ThemeResource RibbonToolbarColorEditContentBackgroundHoverBrush}" />
                                        <Setter Target="PART_ButtonPressedBackground.Fill" Value="{ThemeResource RibbonToolbarColorEditContentBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="HoverBoth">
                                    <VisualState.Setters>
                                        <Setter Target="PART_ArrowHoverBackground.Fill" Value="{ThemeResource RibbonToolbarColorEditArrowBackgroundHoverBrush}" />
                                        <Setter Target="PART_ArrowPressedBackground.Fill" Value="{ThemeResource RibbonToolbarColorEditArrowBackgroundPressedBrush}" />
                                        <Setter Target="PART_ButtonHoverBackground.Fill" Value="{ThemeResource RibbonToolbarColorEditContentBackgroundHoverBrush}" />
                                        <Setter Target="PART_ButtonPressedBackground.Fill" Value="{ThemeResource RibbonToolbarColorEditContentBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Rectangle x:Name="PART_ButtonHoverBackground" Opacity="0" 
                                   />
                        <Rectangle x:Name="PART_ButtonPressedBackground" Opacity="0" 
                                   />

                        <Rectangle x:Name="PART_ArrowHoverBackground" Grid.Column="1"
                                   Opacity="0" 
                                   />
                        <Rectangle x:Name="PART_ArrowPressedBackground" Grid.Column="1"
                                   Opacity="0" 
                                   />

                        <Grid x:Name="PART_Button"
                              Padding="{TemplateBinding Padding}"
                              Grid.ColumnSpan="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <XamlInternal:IconView x:Name="PART_Icon"
                                                   Padding="0,0,8,0"
                                                   UseIconPadding="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToBooleanConverter}}" />
                            <Rectangle x:Name="PART_Indicator"
                                       Height="3" 
                                       Visibility="{Binding ShowIndicator, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}"
                                       Margin="{Binding Padding, ElementName=PART_Icon}"
                                       VerticalAlignment="Bottom"
                                       Fill="{TemplateBinding SelectedBrush}"
                                       HorizontalAlignment="Stretch" />
                            <ContentPresenter x:Name="PART_ButtonText"
                                              VerticalAlignment="Center"
                                              Grid.Column="1"
                                              Visibility="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToVisibilityConverter}}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" />
                        </Grid>
                        <Rectangle x:Name="PART_Separator"
                                   Width="1"
                                   Grid.Column="1"
                                   VerticalAlignment="Stretch"
                                   HorizontalAlignment="Left"
                                   Visibility="Collapsed"
                                   Margin="0,4"
                                   Opacity="1"
                                   Fill="{ThemeResource RibbonToolbarColorEditSeparatorBrush}" />
                        <Grid x:Name="PART_Arrow"
                              Grid.Column="1"
                              Padding="1.5"
                              HorizontalAlignment="Right">
                            <PathIcon x:Name="PART_ArrowGlyph"
                                      Opacity="0"
                                      Data="F1 M 0,0 L 4,3 L 8,0 L 8,2 L 4,5 L 0,2 z"
                                      Foreground="{TemplateBinding Foreground}"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center" />
                            <PathIcon x:Name="PART_FlyoutArrowGlyph"
                                      Visibility="Collapsed"
                                      Data="F1 M 0,0 L 6,6 L 0,12 L 2,12 L 8,6 L 2,0 z"
                                      Foreground="{TemplateBinding Foreground}"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center" />
                        </Grid>
                        <XamlInternal:NestedMenuFlyoutControl x:Name="PART_Flyout"
                                                       AnimationDuration="0:0:0.2"
                                                       x:DeferLoadStrategy="Lazy"
                                                       Grid.ColumnSpan="2"
                                                       CloseOnTargetClick="{TemplateBinding XamlInternal:MenuFlyoutControl.CloseOnTargetClick}"
                                                       Margin="{Binding BorderThickness, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}">
                            <XamlInternal:NestedMenuFlyoutControl.HeaderContent>
                                <Grid Margin="-6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter Content="{TemplateBinding Content}"
                                                      Margin="6"
                                                      ContentTemplate="{TemplateBinding ContentTemplate}" />
                                    <dxr:RibbonToggleButton IconSource="{Binding IsChecked, RelativeSource={RelativeSource Mode=Self}}"
                                                               ClosePopupOnClick="False"
                                                               IconWidth="24"
                                                               IconHeight="24"
                                                               Padding="5"
                                                               Grid.Column="1"
                                                               IsChecked="{Binding IsInAdvancedMode, ElementName=PART_ColorEditor, Mode=TwoWay}">
                                        <dxr:RibbonToggleButton.IconTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Xaml:MultiPath Data="[F#FF323232 M 0 0  l 6 0 0 6 -6 0 z][F#FF686868 M 8 0  l 6 0 0 6 -6 0 z][F#FF9E9E9E M 16 0  l 6 0 0 6 -6 0 z]
                                                                          [F#FF444444 M 0 8  l 6 0 0 6 -6 0 z][F#FF7A7A7A M 8 8  l 6 0 0 6 -6 0 z][F#FFB0B0B0 M 16 8  l 6 0 0 6 -6 0 z]
                                                                          [F#FF565656 M 0 16 l 6 0 0 6 -6 0 z][F#FF8C8C8C M 8 16 l 6 0 0 6 -6 0 z][F#FFC2C2C2 M 16 16 l 6 0 0 6 -6 0 z]"
                                                                    Opacity="{Binding Converter={StaticResource BoolToOpacityInvertConverter}}" />
                                                    <Xaml:MultiPath Data="[F#FFFFFFFF M 0 0  l 6 0 0 6 -6 0 z][F#FFE0E0E0 M 8 0  l 6 0 0 6 -6 0 z][F#FFC0C0C0 M 16 0  l 6 0 0 6 -6 0 z]
                                                                          [F#FFF5F5F5 M 0 8  l 6 0 0 6 -6 0 z][F#FFD5D5D5 M 8 8  l 6 0 0 6 -6 0 z][F#FFB6B6B6 M 16 8  l 6 0 0 6 -6 0 z]
                                                                          [F#FFEAEAEA M 0 16 l 6 0 0 6 -6 0 z][F#FFCBCBCB M 8 16 l 6 0 0 6 -6 0 z][F#FFABABAB M 16 16 l 6 0 0 6 -6 0 z]"
                                                                    Opacity="{Binding Converter={StaticResource BoolToOpacityConverter}}" />
                                                </Grid>
                                            </DataTemplate>
                                        </dxr:RibbonToggleButton.IconTemplate>
                                    </dxr:RibbonToggleButton>
                                </Grid>
                            </XamlInternal:NestedMenuFlyoutControl.HeaderContent>
                            <Editors:ColorEdit x:Name="PART_ColorEditor"
                                               DefaultColor="{TemplateBinding DefaultColor}"
                                               Color="{Binding SelectedColor, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}" 
                                               ColorGroupsSource="{Binding ColorGroups, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                        </XamlInternal:NestedMenuFlyoutControl>
                        <Rectangle x:Name="PART_FocusVisual" 
                                   Grid.ColumnSpan="2" 
                                   IsHitTestVisible="False" 
                                   StrokeThickness="1" 
                                   Opacity="0" 
                                   Stroke="{ThemeResource RibbonToolbarColorEditFocusVisualStrokeBrush}"
                                   Fill="{ThemeResource RibbonToolbarColorEditFocusVisualBackgroundBrush}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style TargetType="dxr:RibbonFontEdit">
        <Setter Property="FontSize" Value="16" />
        <Setter Property="FontFamilyItemTemplate">
            <Setter.Value>
                <DataTemplate>
                    <Grid Margin="0,0,8,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition MinWidth="115" />
                            <ColumnDefinition Width="70" />
                        </Grid.ColumnDefinitions>
                        <TextBlock FontFamily="{Binding}" FontSize="{Binding FontSize, RelativeSource={RelativeSource Mode=TemplatedParent}}" Text="{Binding Source}" HorizontalAlignment="Left" VerticalAlignment="Center" />
                        <TextBlock FontFamily="{Binding}" FontSize="{Binding FontSize, RelativeSource={RelativeSource Mode=TemplatedParent}}" Text="AaBbCc" Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center" />
                    </Grid>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonFontEdit">
                    <Grid Margin="{TemplateBinding Padding}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <dxr:RibbonComboBox Header="Font Family"
                                            MinWidth="240"
                                            Margin="8,7,1,7"
                                            x:Name="PART_FontFamilyCombo"
                                            IsOpen="{Binding IsFontFamilyDropDownOpen, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}"
                                            ItemsSource="{Binding AvailableFonts, RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                            SelectedItem="{Binding ActualSelectedFontFamily, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}"
                                            ItemTemplate="{TemplateBinding FontFamilyItemTemplate}"
                                            SelectedItemTemplate="{TemplateBinding FontFamilyItemTemplate}">
                            <dxr:RibbonComboBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <Border Background="{ThemeResource RibbonFontEditHeaderBackgroundBrush}" Padding="8,4">
                                                <TextBlock Text="{Binding Title}" VerticalAlignment="Center" Foreground="{ThemeResource RibbonFontEditHeaderForegroundBrush}" FontSize="14" />
                                            </Border>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                    <GroupStyle.HeaderContainerStyle>
                                        <Style TargetType="Xaml:DXListViewGroupHeaderContainer">
                                            <Setter Property="MinHeight" Value="20" />
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Xaml:DXListViewGroupHeaderContainer">
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition />
                                                                <RowDefinition Height="Auto" />
                                                            </Grid.RowDefinitions>
                                                            <ContentPresenter HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" />
                                                            <Rectangle Height="1" 
                                                                       StrokeThickness="0" 
                                                                       HorizontalAlignment="Stretch" 
                                                                       Grid.Row="1" 
                                                                       Fill="{ThemeResource RibbonFontEditHeaderSeparatorBrush}" />
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </GroupStyle.HeaderContainerStyle>
                                </GroupStyle>
                            </dxr:RibbonComboBox.GroupStyle>
                        </dxr:RibbonComboBox>
                        <dxr:RibbonComboBox Grid.Column="1"
                                            Header="Font Size"
                                            Margin="1,7,8,7"
                                            MinWidth="70"
                                            ItemsSource="{Binding AvailableFontSizes, RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                            IsOpen="{Binding IsFontSizeDropDownOpen, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}"
                                            SelectedItem="{Binding ActualSelectedFontSize, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}"
                                            x:Name="PART_FontSizeCombo">
                            <dxr:RibbonComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" Width="30" FontSize="{Binding FontSize, RelativeSource={RelativeSource Mode=TemplatedParent}}" VerticalAlignment="Center" />
                                </DataTemplate>
                            </dxr:RibbonComboBox.ItemTemplate>
                        </dxr:RibbonComboBox>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="dxr:RibbonRadioButton">
        <Setter Property="UseSystemFocusVisuals" Value="False" />
        <Setter Property="Background" Value="{ThemeResource RibbonRadioButtonBackgroundBrush}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonRadioButtonForegroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonRadioButtonBorderBrush}" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Padding" Value="12" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonRadioButton">
                    <Grid x:Name="PART_Grid"
                          Margin="{TemplateBinding Padding}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_CommonBorder.Background" Value="{ThemeResource RibbonRadioButtonBackgroundHoverBrush}" />
                                        <Setter Target="PART_CommonBorder.BorderBrush" Value="{ThemeResource RibbonRadioButtonBorderHoverBrush}" />
                                        <Setter Target="PART_SelectionBorder.Background" Value="{ThemeResource RibbonRadioButtonSelectionBackgroundHoverBrush}" />
                                        <Setter Target="PART_SelectionBorder.BorderBrush" Value="{ThemeResource RibbonRadioButtonSelectionBorderBorderHoverBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonRadioButtonIconForegroundHoverBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonRadioButtonForegroundHoverBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_CommonBorder.Background" Value="{ThemeResource RibbonRadioButtonBackgroundPressedBrush}" />
                                        <Setter Target="PART_CommonBorder.BorderBrush" Value="{ThemeResource RibbonRadioButtonBorderPressedBrush}" />
                                        <Setter Target="PART_SelectionBorder.Background" Value="{ThemeResource RibbonRadioButtonSelectionBackgroundPressedBrush}" />
                                        <Setter Target="PART_SelectionBorder.BorderBrush" Value="{ThemeResource RibbonRadioButtonSelectionBorderPressedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonRadioButtonIconForegroundPressedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonRadioButtonForegroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Grid.Opacity" Value="0.4" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="CheckStates">
                                <VisualState x:Name="Checked">
                                    <VisualState.Setters>
                                        <Setter Target="PART_SelectionBorder.Opacity" Value="1" />
                                        <Setter Target="PART_CommonBorder.Opacity" Value="0" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unchecked" />
                                <VisualState x:Name="Indeterminate" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="RibbonStates">
                                <VisualState x:Name="Glyph">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Text" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Icon" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="GlyphWithText" />
                                <VisualState x:Name="Flyout" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Border x:Name="PART_CommonBorder" 
                                Opacity="1" 
                                Grid.ColumnSpan="2"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Margin="{Binding Padding, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}" />
                        <Border x:Name="PART_SelectionBorder"
                                Opacity="0" 
                                Background="{ThemeResource RibbonRadioButtonSelectionBackgroundBrush}"
                                BorderBrush="{ThemeResource RibbonRadioButtonSelectionBorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Grid.ColumnSpan="2"
                                Margin="{Binding Padding, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}" />
                        <XamlInternal:IconView x:Name="PART_Icon"
                                               UseIconPadding="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToBooleanConverter}}" />
                        <ContentPresenter x:Name="PART_Text"
                                          Grid.Column="1"
                                          AutomationProperties.AccessibilityView="Raw"  
                                          Foreground="{TemplateBinding Foreground}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                        <Rectangle x:Name="PART_FocusVisual" 
                                   Grid.ColumnSpan="2" 
                                   IsHitTestVisible="False" 
                                   StrokeThickness="1" 
                                   Opacity="0" 
                                   Stroke="{ThemeResource RibbonRadioButtonFocusVisualStrokeBrush}"
                                   Fill="{ThemeResource RibbonRadioButtonFocusVisualBackgroundBrush}"
                                   Margin="{Binding Padding, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="dxr:RibbonSpinEdit">
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Padding" Value="0,6" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonSpinEdit">
                    <Border BorderThickness="0" BorderBrush="Transparent">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="{TemplateBinding Title}" HorizontalAlignment="Right" Padding="8,0" VerticalAlignment="Center" Foreground="{ThemeResource RibbonSpinEditTitleForegroundBrush}" />
                            <Editors:SpinEdit AllowRoundOutOfRangeValue="{TemplateBinding AllowRoundOutOfRangeValue}"
                                              SelectionHighlightBrush="{ThemeResource RibbonSpinEditSelectionHighlightBrush}"
                                              EditValue="{Binding Value, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=TwoWay}"
                                              BorderBrush="{ThemeResource RibbonSpinEditBorderBrush}"
                                              Foreground="{ThemeResource RibbonSpinEditForegroundBrush}"
                                              MaxValue="{TemplateBinding MaxValue}"
                                              MinValue="{TemplateBinding MinValue}"
                                              Margin="{TemplateBinding Padding}"
                                              HorizontalAlignment="Left"
                                              HorizontalContentAlignment="Left"
                                              BorderThickness="{TemplateBinding BorderThickness}"
                                              Increment="{TemplateBinding Increment}"
                                              TextInputSettings="{TemplateBinding TextInputSettings}"
                                              Grid.Column="1" />
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="dxr:RibbonSplitButton">
        <Setter Property="Background" Value="{ThemeResource RibbonSplitButtonBackgroundBrush}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonSplitButtonForegroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonSplitButtonBorderBrush}" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Padding" Value="12" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonSplitButton">
                    <Grid x:Name="PART_Background"
                          Background="{TemplateBinding Background}"
                          BorderThickness="{TemplateBinding BorderThickness}" 
                          BorderBrush="{TemplateBinding BorderBrush}"
                          >
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected" />
                                <VisualState x:Name="UnselectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonSplitButtonBorderHoverBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowHoverBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonHoverBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="UnselectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonSplitButtonBorderPressedBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowPressedBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonPressedBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Selected">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonSplitButtonBorderSelectedBrush}" />
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonSplitButtonBackgroundSelectedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonSplitButtonBorderSelectedHoverBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowHoverBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonHoverBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonSplitButtonBorderSelectedPressedBrush}" />
                                        <Setter Target="PART_ArrowGlyph.Opacity" Value="1" />
                                        <Setter Target="PART_ArrowPressedBackground.Opacity" Value="1" />
                                        <Setter Target="PART_ButtonPressedBackground.Opacity" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="RibbonStates">
                                <VisualState x:Name="Flyout">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Button" Storyboard.TargetProperty="(Grid.ColumnSpan)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="1" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Separator" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Background" Storyboard.TargetProperty="HorizontalAlignment">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Stretch" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowGlyph" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_FlyoutArrowGlyph" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Arrow" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="16,0" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Button" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="11" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_FocusVisual" Storyboard.TargetProperty="Margin">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Glyph">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Icon" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ButtonText" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="GlyphWithText" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ArrowStates">
                                <VisualState x:Name="ArrowActive" />
                                <VisualState x:Name="ArrowInactive">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Arrow" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="HoverStates">
                                <VisualState x:Name="HoverArrow">
                                    <VisualState.Setters>
                                        <Setter Target="PART_ArrowHoverBackground.Fill" Value="{ThemeResource RibbonSplitButtonArrowBackgroundHoverBrush}" />
                                        <Setter Target="PART_ArrowPressedBackground.Fill" Value="{ThemeResource RibbonSplitButtonArrowBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="HoverButton">
                                    <VisualState.Setters>
                                        <Setter Target="PART_ButtonHoverBackground.Fill" Value="{ThemeResource RibbonSplitButtonContentBackgroundHoverBrush}" />
                                        <Setter Target="PART_ButtonPressedBackground.Fill" Value="{ThemeResource RibbonSplitButtonContentBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="HoverBoth">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Arrow.Opacity" Value="0" />
                                        <Setter Target="PART_ArrowHoverBackground.Fill" Value="{ThemeResource RibbonSplitButtonArrowBackgroundHoverBrush}" />
                                        <Setter Target="PART_ArrowPressedBackground.Fill" Value="{ThemeResource RibbonSplitButtonArrowBackgroundPressedBrush}" />
                                        <Setter Target="PART_ButtonHoverBackground.Fill" Value="{ThemeResource RibbonSplitButtonContentBackgroundHoverBrush}" />
                                        <Setter Target="PART_ButtonPressedBackground.Fill" Value="{ThemeResource RibbonSplitButtonContentBackgroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Rectangle x:Name="PART_ButtonHoverBackground" Opacity="0" 
                                   />
                        <Rectangle x:Name="PART_ButtonPressedBackground" Opacity="0" 
                                   />

                        <Rectangle x:Name="PART_ArrowHoverBackground" Grid.Column="1"
                                   Opacity="0" 
                                   />
                        <Rectangle x:Name="PART_ArrowPressedBackground" Grid.Column="1"
                                   Opacity="0" 
                                   />

                        <Grid x:Name="PART_Button"
                              Padding="{TemplateBinding Padding}"
                              Grid.ColumnSpan="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <XamlInternal:IconView x:Name="PART_Icon"
                                                   Padding="0,0,8,0"
                                                   UseIconPadding="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToBooleanConverter}}" />
                            <ContentPresenter x:Name="PART_ButtonText"
                                              VerticalAlignment="Center"
                                              Grid.Column="1"
                                              Visibility="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToVisibilityConverter}}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" />
                        </Grid>
                        <Rectangle x:Name="PART_Separator"
                                   Width="1"
                                   Grid.Column="1"
                                   VerticalAlignment="Stretch"
                                   HorizontalAlignment="Left"
                                   Visibility="Collapsed"
                                   Margin="0,4"
                                   Opacity="1"
                                   Fill="{ThemeResource RibbonSplitButtonSeparatorBrush}" />
                        <Grid x:Name="PART_Arrow"
                              Grid.Column="1"
                              Padding="1.5"
                              HorizontalAlignment="Right">
                            <PathIcon x:Name="PART_ArrowGlyph"
                                      Opacity="0"
                                      Data="F1 M 0,0 L 4,3 L 8,0 L 8,2 L 4,5 L 0,2 z"
                                      Foreground="{TemplateBinding Foreground}"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center" />
                            <PathIcon x:Name="PART_FlyoutArrowGlyph"
                                      Visibility="Collapsed"
                                      Data="F1 M 0,0 L 6,6 L 0,12 L 2,12 L 8,6 L 2,0 z"
                                      Foreground="{TemplateBinding Foreground}"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center" />
                        </Grid>
                        <XamlInternal:NestedMenuFlyoutControl x:Name="PART_Flyout"
                                                       AnimationDuration="0:0:0.2"
                                                       x:DeferLoadStrategy="Lazy"
                                                       Content="{TemplateBinding FlyoutContent}"
                                                       Grid.ColumnSpan="2"
                                                       CloseOnTargetClick="{TemplateBinding XamlInternal:MenuFlyoutControl.CloseOnTargetClick}"
                                                       Margin="{Binding BorderThickness, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}" />
                        <Rectangle x:Name="PART_FocusVisual" 
                                   Grid.ColumnSpan="2" 
                                   IsHitTestVisible="False" 
                                   StrokeThickness="1" 
                                   Opacity="0" 
                                   Stroke="{ThemeResource RibbonSplitButtonFocusVisualStrokeBrush}"
                                   Fill="{ThemeResource RibbonSplitButtonFocusVisualBackgroundBrush}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--#region TextEditBaseStyle-->
    <ControlTemplate x:Key="TextEdit_BorderTemplate" TargetType="ContentControl">
        <Grid x:Name="PART_Root" Background="Transparent">
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Disabled">
                        <VisualState.Setters>
                            <Setter Target="BackgroundElement.Background" Value="{ThemeResource RibbonTextBoxBackgroundDisabledBrush}" />
                            <Setter Target="BorderElement.BorderBrush" Value="{ThemeResource RibbonTextBoxBorderDisabledBrush}" />
                            <Setter Target="ContentElement.Foreground" Value="{ThemeResource RibbonTextBoxForegroundDisabledBrush}" />
                        </VisualState.Setters>
                    </VisualState>
                    <VisualState x:Name="Invalid">
                        <VisualState.Setters>
                            <Setter Target="BorderElement.BorderBrush" Value="{ThemeResource RibbonTextBoxBorderInvalidBrush}" />
                        </VisualState.Setters>
                    </VisualState>
                    <VisualState x:Name="Normal">
                        <VisualState.Setters>
                            <Setter Target="BackgroundElement.Opacity" Value="{ThemeResource TextControlBackgroundThemeOpacity}" />
                            <Setter Target="BorderElement.Opacity" Value="{ThemeResource TextControlBorderThemeOpacity}" />
                        </VisualState.Setters>
                    </VisualState>
                    <VisualState x:Name="PointerOver">
                        <VisualState.Setters>
                            <Setter Target="BackgroundElement.Opacity" Value="{ThemeResource TextControlPointerOverBackgroundThemeOpacity}" />
                            <Setter Target="BorderElement.Opacity" Value="{ThemeResource TextControlPointerOverBorderThemeOpacity}" />
                        </VisualState.Setters>
                    </VisualState>
                    <VisualState x:Name="Focused" />
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <Border x:Name="BackgroundElement" Background="{TemplateBinding Background}" Grid.ColumnSpan="2" Margin="{TemplateBinding BorderThickness}" />
            <Border x:Name="BorderElement" HorizontalAlignment="Stretch" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" />
            <ContentPresenter x:Name="ContentElement" Margin="{TemplateBinding BorderThickness}" />
            <Editors:EditorPopupContainer>
                <Editors:EditorPopup />
                <Xaml:ValidationFlyout />
            </Editors:EditorPopupContainer>
        </Grid>
    </ControlTemplate>
    <Style x:Key="EditorTextBoxStyle" TargetType="dxi:EditorTextBox" />
    <ControlTemplate x:Key="TextEdit_ButtonsTemplate" TargetType="Editors:TextEdit">
        <ContentControl VerticalAlignment="Stretch"
            VerticalContentAlignment="Center"
            Template="{StaticResource TextEdit_BorderTemplate}"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"
            Background="{TemplateBinding Background}"
            dxi:VisualStateHelper.Manager="{Binding Path=(Editors:PropertyProvider.Properties).BaseEditViewModel.StateManager, RelativeSource={RelativeSource TemplatedParent}}">
            <Editors:ButtonsControl x:Name="PART_Buttons"
                Editors:PropertyProvider.Properties="{TemplateBinding Editors:PropertyProvider.Properties}"
                ItemsSource="{Binding Path=(Editors:PropertyProvider.Properties).ButtonEditViewModel.Buttons, RelativeSource={RelativeSource Self}}">
                <Editors:ButtonsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Editors:ButtonsPanel />
                    </ItemsPanelTemplate>
                </Editors:ButtonsControl.ItemsPanel>
            </Editors:ButtonsControl>
        </ContentControl>
    </ControlTemplate>
    <ControlTemplate x:Key="TextEdit_Template" TargetType="Editors:TextEdit">
        <ContentControl VerticalAlignment="Stretch"
            IsTabStop="False"
            Template="{StaticResource TextEdit_BorderTemplate}"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"
            Background="{TemplateBinding Background}"
            dxi:VisualStateHelper.Manager="{Binding Path=(Editors:PropertyProvider.Properties).BaseEditViewModel.StateManager, RelativeSource={RelativeSource TemplatedParent}}">
            <Grid x:Name="ContentElement" 
                  UseLayoutRounding="True">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Editors:ButtonsControl x:Name="PART_LeftButtons"
                    Editors:PropertyProvider.Properties="{TemplateBinding Editors:PropertyProvider.Properties}"
                    ItemsSource="{Binding Path=(Editors:PropertyProvider.Properties).ButtonEditViewModel.LeftButtons, RelativeSource={RelativeSource Self}}" />
                <Editors:EditorControl x:Name="PART_Content"
                    VerticalAlignment="Stretch"
                    Grid.Column="1"
                    Editors:PropertyProvider.Properties="{TemplateBinding Editors:PropertyProvider.Properties}"
                    ContentTemplate="{Binding Path=ActualEditTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
                <Editors:ButtonsControl x:Name="PART_RightButtons"
                    Editors:PropertyProvider.Properties="{TemplateBinding Editors:PropertyProvider.Properties}"
                    Grid.Column="2"
                    ItemsSource="{Binding Path=(Editors:PropertyProvider.Properties).ButtonEditViewModel.RightButtons, RelativeSource={RelativeSource Self}}" />
            </Grid>
        </ContentControl>
    </ControlTemplate>
    <DataTemplate x:Key="TextEdit_EditTemplate">
        <dxi:EditorTextBox x:Name="PART_Editor"
            Style="{StaticResource EditorTextBoxStyle}"
            SelectionHighlightColor="{Binding Path=(Editors:PropertyProvider.Properties).Editor.SelectionHighlightBrush, RelativeSource={RelativeSource TemplatedParent}}"
            MaxLength="{Binding Path=(Editors:PropertyProvider.Properties).Editor.MaxLength, RelativeSource={RelativeSource TemplatedParent}}"
            InputScope="{Binding Path=(Editors:PropertyProvider.Properties).Editor.InputScope, RelativeSource={RelativeSource TemplatedParent}}"
            TextWrapping="{Binding Path=(Editors:PropertyProvider.Properties).Editor.TextWrapping, RelativeSource={RelativeSource TemplatedParent}}"
            AcceptsReturn="{Binding Path=(Editors:PropertyProvider.Properties).Editor.AcceptsReturn, RelativeSource={RelativeSource TemplatedParent}}"
            IsTextPredictionEnabled="{Binding Path=(Editors:PropertyProvider.Properties).Editor.IsTextPredictionEnabled, RelativeSource={RelativeSource TemplatedParent}}"
            IsReadOnly="{Binding Path=(Editors:PropertyProvider.Properties).Editor.IsReadOnly, RelativeSource={RelativeSource TemplatedParent}}"
            VerticalContentAlignment="{Binding Path=(Editors:PropertyProvider.Properties).Editor.VerticalContentAlignment, RelativeSource={RelativeSource TemplatedParent}}"
            NullTextForeground="{Binding Path=(Editors:PropertyProvider.Properties).Editor.NullTextForeground, RelativeSource={RelativeSource TemplatedParent}}"
            Padding="{Binding Path=(Editors:PropertyProvider.Properties).Editor.Padding, RelativeSource={RelativeSource Self}}" />
    </DataTemplate>
    <DataTemplate x:Key="TextEdit_EditNonEditableTemplate">
        <TextBlock x:Name="PART_Editor"
            VerticalAlignment="{Binding Path=(Editors:PropertyProvider.Properties).Editor.VerticalContentAlignment, RelativeSource={RelativeSource TemplatedParent}}"
            Padding="{Binding Path=(Editors:PropertyProvider.Properties).Editor.Padding, RelativeSource={RelativeSource Self}}" />
    </DataTemplate>
    <Style TargetType="dxr:RibbonTextBox">
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        <Setter Property="VerticalAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Width" Value="100" />
        <Setter Property="Height" Value="18" />
        <Setter Property="MinWidth" Value="{ThemeResource TextControlThemeMinWidth}" />
        <Setter Property="MinHeight" Value="{ThemeResource TextControlThemeMinHeight}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonTextBoxForegroundBrush}" />
        <Setter Property="Background" Value="{ThemeResource RibbonTextBoxBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonTextBoxBorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Margin" Value="8,7" />
        <Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}" />
        <Setter Property="FontSize" Value="{ThemeResource ControlContentThemeFontSize}" />
        <Setter Property="Padding" Value="{ThemeResource TextControlThemePadding}" />
        <Setter Property="NullTextForeground" Value="{ThemeResource RibbonTextBoxNullTextForegroundBrush}" />
        <Setter Property="ButtonsTemplate" Value="{StaticResource TextEdit_ButtonsTemplate}" />
        <Setter Property="TextTemplate" Value="{StaticResource TextEdit_Template}" />
        <Setter Property="EditTemplate" Value="{StaticResource TextEdit_EditTemplate}" />
        <Setter Property="EditNonEditableTemplate" Value="{StaticResource TextEdit_EditNonEditableTemplate}" />
        <Setter Property="SelectionHighlightBrush" Value="{ThemeResource RibbonTextBoxSelectionHighlightBrush}" />
        <Setter Property="Core:StyleHelper.BindableSetters">
            <Setter.Value>
                <Core:BindableSetterCollection>
                    <Core:BindableSetter Property="Template" Binding="{Binding Path=(Editors:PropertyProvider.Properties).ButtonEditViewModel.ActualTemplate, RelativeSource={RelativeSource Self}}" />
                </Core:BindableSetterCollection>
            </Setter.Value>
        </Setter>
    </Style>
    <!--#endregion-->
    <Style TargetType="dxr:RibbonToggleButton">
        <Setter Property="Background" Value="{ThemeResource RibbonToggleButtonBackgroundBrush}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonToggleButtonForegroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonToggleButtonBorderBrush}" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Padding" Value="11" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonToggleButton">
                    <Grid x:Name="PART_Background"
                          Background="{TemplateBinding Background}"
                          BorderThickness="{TemplateBinding BorderThickness}" 
                          BorderBrush="{TemplateBinding BorderBrush}"
                          Padding="{TemplateBinding Padding}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Opacity" Value="0.4" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="CheckStates">
                                <VisualState x:Name="Checked">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonToggleButtonBackgroundCheckedBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToggleButtonBorderCheckedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonToggleButtonIconForegroundCheckedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonToggleButtonForegroundCheckedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="CheckedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonToggleButtonBackgroundCheckedHoverBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToggleButtonBorderCheckedHoverBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonToggleButtonIconForegroundCheckedHoverBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonToggleButtonForegroundCheckedHoverBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="CheckedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonToggleButtonBackgroundCheckedPressedBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToggleButtonBorderCheckedPressedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonToggleButtonIconForegroundCheckedPressedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonToggleButtonForegroundCheckedPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unchecked" />
                                <VisualState x:Name="UncheckedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonToggleButtonBackgroundHoverBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToggleButtonBorderHoverBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonToggleButtonIconForegroundHoverBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonToggleButtonForegroundHoverBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="UncheckedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonToggleButtonBackgroundPressedBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToggleButtonBorderPressedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonToggleButtonIconForegroundPressedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonToggleButtonForegroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Indeterminate" />
                                <VisualState x:Name="IndeterminatePointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonToggleButtonBackgroundIndeterminateHoverBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToggleButtonBorderIndeterminateHoverBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonToggleButtonIconForegroundIndeterminateHoverBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonToggleButtonForegroundIndeterminateHoverBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="IndeterminatePressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonToggleButtonBackgroundIndeterminatePressedBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonToggleButtonBorderIndeterminatePressedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonToggleButtonIconForegroundIndeterminatePressedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonToggleButtonForegroundIndeterminatePressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="RibbonStates">
                                <VisualState x:Name="Flyout">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.HorizontalAlignment" Value="Stretch" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Glyph">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Text" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Icon" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="GlyphWithText" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <XamlInternal:IconView x:Name="PART_Icon"
                                               UseIconPadding="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToBooleanConverter}}" />
                        <ContentPresenter x:Name="PART_Text"
                                          Grid.Column="1"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                          />
                        <Rectangle x:Name="PART_FocusVisual" 
                                   Grid.ColumnSpan="2" 
                                   IsHitTestVisible="False" 
                                   StrokeThickness="1" 
                                   Opacity="0" 
                                   Stroke="{ThemeResource RibbonToggleButtonFocusVisualStrokeBrush}"
                                   Fill="{ThemeResource RibbonToggleButtonFocusVisualBackgroundBrush}"
                                   Margin="{Binding Padding, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="dxr:RibbonMenuButton">
        <Setter Property="UseSystemFocusVisuals" Value="False" />
        <Setter Property="Background" Value="{ThemeResource RibbonMenuButtonBackgroundBrush}" />
        <Setter Property="Foreground" Value="{ThemeResource RibbonMenuButtonForegroundBrush}" />
        <Setter Property="BorderBrush" Value="{ThemeResource RibbonMenuButtonBorderBrush}" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="Padding" Value="11" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="dxr:RibbonMenuButton">
                    <Grid x:Name="PART_Background"
                          Background="{TemplateBinding Background}"
                          BorderThickness="{TemplateBinding BorderThickness}" 
                          BorderBrush="{TemplateBinding BorderBrush}"
                          Padding="{TemplateBinding Padding}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Opacity" Value="0.4" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected" />
                                <VisualState x:Name="UnselectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonMenuButtonBackgroundHoverBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonMenuButtonBorderHoverBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonMenuButtonIconForegroundHoverBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonMenuButtonForegroundHoverBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="UnselectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonMenuButtonBackgroundPressedBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonMenuButtonBorderPressedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonMenuButtonIconForegroundPressedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonMenuButtonForegroundPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Selected">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonMenuButtonBackgroundSelectedBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonMenuButtonBorderSelectedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonMenuButtonIconForegroundSelectedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonMenuButtonForegroundSelectedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonMenuButtonBackgroundSelectedHoverBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonMenuButtonBorderSelectedHoverBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonMenuButtonIconForegroundSelectedHoverBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonMenuButtonForegroundSelectedHoverBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource RibbonMenuButtonBackgroundSelectedPressedBrush}" />
                                        <Setter Target="PART_Background.BorderBrush" Value="{ThemeResource RibbonMenuButtonBorderSelectedPressedBrush}" />
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource RibbonMenuButtonIconForegroundSelectedPressedBrush}" />
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource RibbonMenuButtonForegroundSelectedPressedBrush}" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="RibbonStates">
                                <VisualState x:Name="Flyout">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowGlyph" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Glyph">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Text" Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Icon" Storyboard.TargetProperty="Padding">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="GlyphWithText" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <XamlInternal:IconView x:Name="PART_Icon"
                                               UseIconPadding="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToBooleanConverter}}" />
                        <ContentPresenter x:Name="PART_Text"
                                          Grid.Column="1"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                          />
                        <Path x:Name="PART_ArrowGlyph"
                              Grid.Column="2"
                              Data="F1 M 0,0 L 6,6 L 0,12 L 2,12 L 8,6 L 2,0 z"
                              Fill="{Binding Foreground, ElementName=PART_Text}"
                              Visibility="Collapsed"
                              Margin="16,0,4,0"
                              VerticalAlignment="Center" />
                        <XamlInternal:NestedMenuFlyoutControl x:Name="PART_Flyout"
                                                       AnimationDuration="0:0:0.3"
                                                       x:DeferLoadStrategy="Lazy"
                                                       CloseOnTargetClick="{TemplateBinding XamlInternal:MenuFlyoutControl.CloseOnTargetClick}"
                                                       Grid.ColumnSpan="3"
                                                       Margin="{Binding BorderThickness, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}">
                            <Internal:FlyoutItemsContentHost ItemsSource="{Binding Items, RelativeSource={RelativeSource Mode=TemplatedParent}, Mode=OneTime}"
                                                             ColumnCount="{TemplateBinding FlyoutColumnCount}" />
                        </XamlInternal:NestedMenuFlyoutControl>
                        <Rectangle x:Name="PART_FocusVisual" 
                                   Grid.ColumnSpan="3" 
                                   IsHitTestVisible="False" 
                                   StrokeThickness="1" 
                                   Opacity="0" 
                                   Stroke="{ThemeResource RibbonMenuButtonFocusVisualStrokeBrush}" 
                                   Fill="{ThemeResource RibbonMenuButtonFocusVisualBackgroundBrush}"
                                   Margin="{Binding Padding, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
