<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Ribbon="using:DevExpress.UI.Xaml.Ribbon"
    xmlns:Xaml="using:DevExpress.UI.Xaml"
    xmlns:Core="using:DevExpress.Core"
    xmlns:Internal="using:DevExpress.UI.Xaml.Ribbon.Internal"
    xmlns:XamlInternal="using:DevExpress.UI.Xaml.Internal"
    xmlns:Controls="using:DevExpress.UI.Xaml.Controls">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="ms-appx:///DevExpress.UI.Xaml.Ribbon.v19.2/Themes/Backstage.Colors.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <Internal:ThicknessNegationConverter x:Key="ThicknessNegationConverter"/>
    <Core:ObjectToBooleanConverter x:Key="ObjectToBooleanConverter"/>
    <DataTemplate x:Key="WindowTitleSettings">
        <Xaml:TitleSettings
                        Background="{ThemeResource BackstageViewWindowTitleBackgroundBrush}"
                        InactiveBackground="{ThemeResource BackstageViewWindowTitleInactiveBackgroundBrush}"
                        ButtonBackground="{ThemeResource BackstageViewWindowTitleButtonBackgroundBrush}"
                        ButtonHoverBackground="{ThemeResource BackstageViewWindowTitleButtonBackgroundHoverBrush}"
                        ButtonPressedBackground="{ThemeResource BackstageViewWindowTitleButtonBackgroundPressedBrush}"
                        ButtonInactiveBackground="{ThemeResource BackstageViewWindowTitleButtonInactiveBackgroundBrush}"
                        Foreground="{ThemeResource BackstageViewWindowTitleForegroundBrush}"
                        InactiveForeground="{ThemeResource BackstageViewWindowTitleInactiveForegroundBrush}"
                        ButtonForeground="{ThemeResource BackstageViewWindowTitleButtonForegroundBrush}"
                        ButtonHoverForeground="{ThemeResource BackstageViewWindowTitleButtonForegroundHoverBrush}"
                        ButtonPressedForeground="{ThemeResource BackstageViewWindowTitleButtonForegroundPressedBrush}"
                        ButtonInactiveForeground="{ThemeResource BackstageViewWindowTitleButtonInactiveForegroundBrush}"/>
    </DataTemplate>

    <Style TargetType="Ribbon:BackstageView">
        <Setter Property="Core:StyleHelper.BindableSetters">
            <Setter.Value>
                <Core:BindableSetterCollection>
                    <Core:BindableSetter Property="TitleSettings" 
                                         Binding="{Binding Source={StaticResource WindowTitleSettings}, Converter={Core:TemplateInstanceConverter}, Mode=OneTime}"/>
                </Core:BindableSetterCollection>
            </Setter.Value>
        </Setter>
        <Setter Property="Background" Value="{ThemeResource RibbonBackstageBackgroundBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Ribbon:BackstageView">
                    <Grid Background="{TemplateBinding Background}"
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          VerticalAlignment="Stretch"
                          HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        
                        <Border Background="{ThemeResource RibbonBackstageTabsBackgroundBrush}" 
                                Grid.RowSpan="2"/>
                        <ItemsControl x:Name="PART_ItemsControl"
                                      ItemsSource="{Binding Items, RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                      Grid.Row="1"/>
                        <Ribbon:BackstageButtonItem x:Name="PART_CloseButton" 
                                                    IconSource="M 15.5 0 C 6.9396457 0 0 6.9381636 0 15.496822 c 0 8.558659 6.9396457 15.496822 15.500132 15.496822 8.560487 0 15.500133 -6.938163 15.500133 -15.496822 C 31.000265 6.9381636 24.060619 0 15.500132 0 Z
                                                                m 0 0.96855138 A 14.531374 14.528271 0 0 1 30.031507 15.496822 14.531374 14.528271 0 0 1 15.500132 30.025093 14.531374 14.528271 0 0 1 0.96875828 15.496822 14.531374 14.528271 0 0 1 15.500132 0.96855138
                                                                M 6.5 15.5 16.25 5.75 17 6.5 8.5 15 25 15 25 16 8.5 16 17 24.5 16.25 25.25 6.5 15.5 Z"
                                                    Command="{Binding CloseCommand, RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                                    IconWidth="32"
                                                    IconHeight="32"
                                                    HorizontalAlignment="Stretch"
                                                    Padding="20,10"/>
                        <ContentPresenter Grid.Column="1"
                                          Grid.RowSpan="2"
                                          VerticalAlignment="Stretch"
                                          HorizontalAlignment="Stretch"
                                          Background="{ThemeResource RibbonBackstageTabContentBackgroundBrush}"
                                          Content="{Binding SelectedTab.ControlPane, RelativeSource={RelativeSource Mode=TemplatedParent}}"/>
                        <Border x:Name="PART_TitleBarBorder"
                                Background="Transparent"
                                IsHitTestVisible="True"
                                Grid.Column="1"
                                VerticalAlignment="Top"
                                Height="32"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="Ribbon:BackstageTabItem">
        <Setter Property="UseSystemFocusVisuals" Value="False"/>
        <Setter Property="Padding" Value="14,18,28,18"/>
        <Setter Property="FontSize" Value="20"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="Foreground" Value="{ThemeResource BackstageTabItemForegroundBrush}"/>
        <Setter Property="Background" Value="{ThemeResource BackstageTabItemBackgroundBrush}"/>
        <Setter Property="ClosePopupOnClick" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Ribbon:BackstageTabItem">
                    <Grid x:Name="PART_Background"
                          Background="{TemplateBinding Background}"
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          Padding="{TemplateBinding Padding}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="Disabled">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Opacity" Value="0.4"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected"/>
                                <VisualState x:Name="UnselectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource BackstageTabItemBackgroundHoverBrush}"/>
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource BackstageTabItemIconForegroundHoverBrush}"/>
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource BackstageTabItemForegroundHoverBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="UnselectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource BackstageTabItemBackgroundPressedBrush}"/>
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource BackstageTabItemIconForegroundPressedBrush}"/>
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource BackstageTabItemForegroundPressedBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Selected">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource BackstageTabItemBackgroundSelectedBrush}"/>
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource BackstageTabItemIconForegroundSelectedBrush}"/>
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource BackstageTabItemForegroundSelectedBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPointerOver">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource BackstageTabItemBackgroundSelectedHoverBrush}"/>
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource BackstageTabItemIconForegroundSelectedHoverBrush}"/>
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource BackstageTabItemForegroundSelectedHoverBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="SelectedPressed">
                                    <VisualState.Setters>
                                        <Setter Target="PART_Background.Background" Value="{ThemeResource BackstageTabItemBackgroundSelectedPressedBrush}"/>
                                        <Setter Target="PART_Icon.Foreground" Value="{ThemeResource BackstageTabItemIconForegroundSelectedPressedBrush}"/>
                                        <Setter Target="PART_Text.Foreground" Value="{ThemeResource BackstageTabItemForegroundSelectedPressedBrush}"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <VisualState.Setters>
                                        <Setter Target="PART_FocusVisual.Opacity" Value="0.9"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                                <VisualState x:Name="PointerFocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Border x:Name="PART_FocusVisual"
                                Margin="{Binding Padding, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ThicknessNegationConverter}}"
                                Grid.ColumnSpan="2"
                                x:DeferLoadStrategy="Lazy"
                                IsHitTestVisible="False"
                                BorderThickness="0"
                                Opacity="0"
                                BorderBrush="{ThemeResource BackstageTabItemFocusVisualStrokeBrush}"
                                Background="{ThemeResource BackstageTabItemFocusVisualBackgroundBrush}"/>
                        <XamlInternal:NestedMenuFlyoutControl x:Name="PART_Flyout"
                                                       x:DeferLoadStrategy="Lazy"
                                                       HeaderEnabledMode="Auto"
                                                       BackButtonEnabledMode="Auto"
                                                       VerticalContentAlignment="Stretch"
                                                       HorizontalContentAlignment="Stretch"
                                                       VerticalAlignment="Stretch"
                                                       HorizontalAlignment="Stretch"
                                                       Content="{TemplateBinding ControlPane}"/>
                        <XamlInternal:IconView x:Name="PART_Icon"
                                            Foreground="{TemplateBinding Foreground}"
                                            Owner="{Binding RelativeSource={RelativeSource Mode=TemplatedParent}}"
                                            UseIconPadding="{Binding Content, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ObjectToBooleanConverter}}"/>
                        <ContentPresenter x:Name="PART_Text"
                                            Grid.Column="1"
                                            VerticalAlignment="Center" 
                                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                            Foreground="{TemplateBinding Foreground}"
                                            Content="{TemplateBinding Content}"/>
                        <!--for binding purposes-->
                        <ContentControl Content="{TemplateBinding ControlPane}"
                                        VerticalContentAlignment="Center"
                                        HorizontalContentAlignment="Center">
                            <ContentControl.Template>
                                <ControlTemplate>
                                    <Rectangle/>
                                </ControlTemplate>
                            </ContentControl.Template>
                        </ContentControl>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>

